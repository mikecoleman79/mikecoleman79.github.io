<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>WooCommerce Age Verification Integration – Michael Coleman</title>

  <style>
    body {
      font-family: system-ui, -apple-system, BlinkMacSystemFont, "Segoe UI", sans-serif;
      line-height: 1.65;
      max-width: 780px;
      margin: 3rem auto;
      padding: 0 1rem;
      color: #111;
    }

    h1, h2, h3 {
      line-height: 1.25;
      margin-top: 2.5rem;
    }

    h1 {
      margin-top: 0;
    }

    p {
      margin: 1rem 0;
    }

    ul {
      margin: 1rem 0 1rem 1.25rem;
    }

    li {
      margin-bottom: 0.5rem;
    }

    a {
      color: #0366d6;
      text-decoration: none;
    }

    a:hover {
      text-decoration: underline;
    }

    .meta {
      color: #555;
      margin: 1.5rem 0 2.5rem;
    }

    .section {
      margin-bottom: 2.5rem;
    }

    .back {
      margin-bottom: 2rem;
    }

    .tag {
      display: inline-block;
      background: #f2f2f2;
      padding: 0.25rem 0.5rem;
      border-radius: 4px;
      font-size: 0.85rem;
      margin-right: 0.5rem;
    }
  </style>
</head>
<body>

  <p class="back">
    <a href="/">← Back to home</a>
  </p>

  <h1>Age Verification Integration for Restricted WooCommerce Products</h1>

  <div class="meta">
    <p>
      <strong>Role:</strong> Senior WordPress Developer<br>
      <strong>Agency:</strong> Popcorn Web Design<br>
      <strong>Client:</strong> E-commerce / Retail (NDA)
    </p>
    <p>
      <span class="tag">WordPress</span>
      <span class="tag">WooCommerce</span>
      <span class="tag">PHP</span>
      <span class="tag">JavaScript</span>
      <span class="tag">OneID API</span>
      <span class="tag">OAuth</span>
    </p>
  </div>

  <div class="section">
    <h2>Overview</h2>
    <p>
      I delivered a compliant age verification solution for an existing WooCommerce
      site selling a mix of standard and age-restricted products.
    </p>
    <p>
      The solution required integrating a third-party age verification provider
      (<strong>OneID</strong>) while maintaining a low-friction checkout experience
      for non-restricted purchases.
    </p>
  </div>

  <div class="section">
    <h2>The Problem</h2>
    <p>
      The client needed to enforce age checks for specific products to meet legal
      and regulatory requirements, without introducing unnecessary confirmation
      steps across the entire store.
    </p>
    <p>
      Key challenges included:
    </p>
    <ul>
      <li>No native age verification support in WooCommerce</li>
      <li>Only certain products requiring verification</li>
      <li>Zero tolerance for storing sensitive personal data</li>
      <li>Existing checkout flow needed to remain intact</li>
    </ul>
  </div>

  <div class="section">
    <h2>Constraints</h2>
    <ul>
      <li>Third-party verification service outside direct control</li>
      <li>API availability and error handling considerations</li>
      <li>Requirement to support sandbox and production environments</li>
      <li>Site remained live throughout development</li>
    </ul>
  </div>

  <div class="section">
    <h2>Solution</h2>

    <h3>API Setup & Authentication</h3>
    <ul>
      <li>Registered and configured OneID API credentials</li>
      <li>Implemented OAuth token handling for secure requests</li>
      <li>Verified API connectivity using Postman and cURL</li>
    </ul>

    <h3>Verification Request Handling</h3>
    <ul>
      <li>Custom API handler for verification requests</li>
      <li>Normalised verified / not-verified states</li>
      <li>Graceful handling of failed or incomplete verifications</li>
    </ul>

    <h3>WooCommerce Cart & Checkout Logic</h3>
    <ul>
      <li>Introduced a custom product meta flag for age-restricted items</li>
      <li>Scanned cart contents to detect restricted products</li>
      <li>Stored verification state securely in the session</li>
      <li>Blocked checkout using <code>woocommerce_checkout_process</code></li>
    </ul>

    <h3>User Experience Considerations</h3>
    <ul>
      <li>Clear messaging when verification is required</li>
      <li>Modal or redirect-based verification flow</li>
      <li>No disruption to standard product purchases</li>
    </ul>
  </div>

  <div class="section">
    <h2>Testing & Deployment</h2>
    <ul>
      <li>Tested mixed carts with restricted and unrestricted products</li>
      <li>Handled API downtime and timeout scenarios</li>
      <li>Optimised session handling across page reloads</li>
      <li>Deployed from sandbox to production with logging enabled</li>
    </ul>
  </div>

  <div class="section">
    <h2>Outcome</h2>
    <ul>
      <li>Legally compliant age verification flow</li>
      <li>No negative impact on standard checkout journeys</li>
      <li>Secure, stateless handling of verification data</li>
      <li>Maintainable, plugin-based architecture</li>
    </ul>
  </div>

  <div class="section">
    <h2>Notes</h2>
    <p>
      Due to NDA restrictions, code samples and deeper technical details
      are available to discuss on request.
    </p>
  </div>

</body>
</html>
